<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webhook Simulator - n8n AI ì‘ë‹µ ì‹œë®¬ë ˆì´í„°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .card h2 {
            color: #f5576c;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #f5576c;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 600;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #f5576c;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
            font-family: 'Courier New', monospace;
        }

        .btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-right: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(245, 87, 108, 0.4);
        }

        .btn-all {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .response {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
        }

        .response.success {
            border-left: 4px solid #28a745;
        }

        .response.error {
            border-left: 4px solid #dc3545;
        }

        .info-box {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .info-box h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .info-box p {
            color: #856404;
            line-height: 1.6;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }

        code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– Webhook Simulator</h1>
            <p>n8n AI ì‘ë‹µ ì‹œë®¬ë ˆì´í„° (ê°œë°œ/í…ŒìŠ¤íŠ¸ìš©)</p>
        </div>

        <div class="info-box">
            <h3>ğŸ“˜ ì‚¬ìš© ë°©ë²•</h3>
            <p>
                1. <strong>frontend_demo.html</strong>ì—ì„œ ì§ˆë¬¸ì„ ë“±ë¡í•˜ì„¸ìš”<br>
                2. Chapter IDë¥¼ í™•ì¸í•˜ì„¸ìš”<br>
                3. ì´ í˜ì´ì§€ì—ì„œ í•´ë‹¹ Chapter IDë¥¼ ì…ë ¥í•˜ê³  webhookì„ í˜¸ì¶œí•˜ì„¸ìš”<br>
                4. Socket.IOë¡œ ì‹¤ì‹œê°„ ì•Œë¦¼ì´ ì „ì†¡ë˜ê³ , í”„ë¡ íŠ¸ì—”ë“œì—ì„œ í•™ìŠµ í˜ì´ì§€ê°€ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤
            </p>
        </div>

        <div class="card">
            <h2>ğŸ¯ Webhook í˜¸ì¶œ</h2>

            <div class="form-group">
                <label>Chapter ID</label>
                <input type="number" id="chapterId" placeholder="1" value="1">
            </div>

            <div class="grid">
                <button class="btn" onclick="sendConceptWebhook()">ğŸ“ ê°œë… ì •ë¦¬ ì™„ë£Œ</button>
                <button class="btn" onclick="sendExerciseWebhook()">ğŸ’» ì‹¤ìŠµ ê³¼ì œ ì™„ë£Œ</button>
                <button class="btn" onclick="sendQuizWebhook()">âœ… í€´ì¦ˆ ì™„ë£Œ</button>
            </div>

            <button class="btn btn-all" onclick="sendAllWebhooks()" style="margin-top: 15px; width: 100%;">
                ğŸš€ ëª¨ë“  Webhook í•œë²ˆì— ì „ì†¡ (3ì´ˆ ê°„ê²©)
            </button>

            <div id="response"></div>
        </div>

        <div class="card">
            <h2>âš™ï¸ ì»¤ìŠ¤í…€ ë°ì´í„°</h2>

            <div class="form-group">
                <label>ê°œë… ì •ë¦¬ ì œëª©</label>
                <input type="text" id="conceptTitle" placeholder="ë¦¬ìŠ¤íŠ¸ vs íŠœí”Œ" value="ë¦¬ìŠ¤íŠ¸ vs íŠœí”Œ">
            </div>

            <div class="form-group">
                <label>ê°œë… ì •ë¦¬ ë‚´ìš©</label>
                <textarea id="conceptContent">ë¦¬ìŠ¤íŠ¸ëŠ” mutable(ê°€ë³€)ì´ê³  íŠœí”Œì€ immutable(ë¶ˆë³€)ì…ë‹ˆë‹¤.
ë¦¬ìŠ¤íŠ¸ëŠ” [ ] ë¡œ ì„ ì–¸í•˜ë©° ìš”ì†Œë¥¼ ì¶”ê°€, ì‚­ì œ, ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
íŠœí”Œì€ ( ) ë¡œ ì„ ì–¸í•˜ë©° í•œë²ˆ ìƒì„±ë˜ë©´ ë‚´ìš©ì„ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</textarea>
            </div>

            <div class="form-group">
                <label>ì‹¤ìŠµ ê³¼ì œ ì§ˆë¬¸</label>
                <textarea id="exerciseQuestion">ë‹¤ìŒ ë¦¬ìŠ¤íŠ¸ë¥¼ íŠœí”Œë¡œ ë³€í™˜í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ì„¸ìš”:
my_list = [1, 2, 3, 4, 5]</textarea>
            </div>

            <div class="form-group">
                <label>ì‹¤ìŠµ ê³¼ì œ ë‹µì•ˆ</label>
                <textarea id="exerciseAnswer">my_list = [1, 2, 3, 4, 5]
my_tuple = tuple(my_list)
print(my_tuple)  # (1, 2, 3, 4, 5)</textarea>
            </div>

            <div class="form-group">
                <label>í€´ì¦ˆ ì§ˆë¬¸</label>
                <input type="text" id="quizQuestion" placeholder="íŠœí”Œì€ ìˆ˜ì •ì´ ê°€ëŠ¥í•œê°€ìš”?" value="íŠœí”Œì€ ìˆ˜ì •ì´ ê°€ëŠ¥í•œê°€ìš”?">
            </div>

            <div class="form-group">
                <label>í€´ì¦ˆ ì„ íƒì§€ (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
                <input type="text" id="quizOptions" placeholder="ê°€ëŠ¥í•˜ë‹¤, ë¶ˆê°€ëŠ¥í•˜ë‹¤" value="ê°€ëŠ¥í•˜ë‹¤, ë¶ˆê°€ëŠ¥í•˜ë‹¤">
            </div>

            <div class="form-group">
                <label>í€´ì¦ˆ ì •ë‹µ</label>
                <input type="text" id="quizAnswer" placeholder="ë¶ˆê°€ëŠ¥í•˜ë‹¤" value="ë¶ˆê°€ëŠ¥í•˜ë‹¤">
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000';

        function showResponse(message, isSuccess = true) {
            const responseDiv = document.getElementById('response');
            responseDiv.className = isSuccess ? 'response success' : 'response error';
            responseDiv.textContent = message;
        }

        async function sendConceptWebhook() {
            const chapterId = document.getElementById('chapterId').value;
            const title = document.getElementById('conceptTitle').value;
            const content = document.getElementById('conceptContent').value;

            try {
                const response = await fetch(`${API_BASE}/v1/chapter/${chapterId}/concept-finish`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ title, content })
                });

                const data = await response.json();

                if (response.ok) {
                    showResponse(`âœ… ê°œë… ì •ë¦¬ Webhook ì „ì†¡ ì„±ê³µ\n\n${JSON.stringify(data, null, 2)}`);
                } else {
                    showResponse(`âŒ ì—ëŸ¬: ${JSON.stringify(data, null, 2)}`, false);
                }
            } catch (error) {
                showResponse(`âŒ ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬: ${error.message}`, false);
            }
        }

        async function sendExerciseWebhook() {
            const chapterId = document.getElementById('chapterId').value;
            const question = document.getElementById('exerciseQuestion').value;
            const answer = document.getElementById('exerciseAnswer').value;

            try {
                const response = await fetch(`${API_BASE}/v1/chapter/${chapterId}/exercise-finish`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ question, answer })
                });

                const data = await response.json();

                if (response.ok) {
                    showResponse(`âœ… ì‹¤ìŠµ ê³¼ì œ Webhook ì „ì†¡ ì„±ê³µ\n\n${JSON.stringify(data, null, 2)}`);
                } else {
                    showResponse(`âŒ ì—ëŸ¬: ${JSON.stringify(data, null, 2)}`, false);
                }
            } catch (error) {
                showResponse(`âŒ ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬: ${error.message}`, false);
            }
        }

        async function sendQuizWebhook() {
            const chapterId = document.getElementById('chapterId').value;
            const question = document.getElementById('quizQuestion').value;
            const optionsStr = document.getElementById('quizOptions').value;
            const correctAnswer = document.getElementById('quizAnswer').value;

            const options = optionsStr.split(',').map(opt => opt.trim());

            try {
                const response = await fetch(`${API_BASE}/v1/chapter/${chapterId}/quiz-finish`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        question,
                        options,
                        correct_answer: correctAnswer,
                        type: 'multiple'
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    showResponse(`âœ… í€´ì¦ˆ Webhook ì „ì†¡ ì„±ê³µ\n\n${JSON.stringify(data, null, 2)}`);
                } else {
                    showResponse(`âŒ ì—ëŸ¬: ${JSON.stringify(data, null, 2)}`, false);
                }
            } catch (error) {
                showResponse(`âŒ ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬: ${error.message}`, false);
            }
        }

        async function sendAllWebhooks() {
            showResponse('ğŸš€ ëª¨ë“  Webhook ì „ì†¡ ì‹œì‘...\n(3ì´ˆ ê°„ê²©ìœ¼ë¡œ ìˆœì°¨ ì „ì†¡)');

            await sendConceptWebhook();
            await sleep(3000);

            await sendExerciseWebhook();
            await sleep(3000);

            await sendQuizWebhook();

            showResponse('âœ… ëª¨ë“  Webhook ì „ì†¡ ì™„ë£Œ!');
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>
